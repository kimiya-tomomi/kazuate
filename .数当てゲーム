import random

def number_guessing_game():
    """数当てゲームのメイン関数"""
    print("=== 数当てゲーム ===")
    print("1から100の数字を当ててください！")
    print("ヒント: もっと大きい/もっと小さいで教えます")
    print("-" * 40)
    
    # コンピューターがランダムな数字を選ぶ
    correct_number = random.randint(1, 100)
    attempts = 0
    
    # メインゲームループ
    while True:
        try:
            # ユーザーの入力
            guess_input = input("数字を入力してください (1-100): ")


            guess = int(guess_input)
            attempts += 1
            
            # 範囲チェック
            if guess < 1 or guess > 100:
                print("エラー: 1から100の間の数字を入力してください")
                attempts -= 1  # 無効な入力は試行回数にカウントしない
                continue
            
            # 判定とヒント
            if guess == correct_number:
                print(f"\n🎉 正解です！おめでとうございます！")
                print(f"答えは {correct_number} でした")
                print(f"試行回数: {attempts}回")
                
                # 試行回数による評価
                if attempts <= 3:
                    print("素晴らしい！とても少ない回数で当てました！")
                elif attempts <= 7:
                    print("良い結果です！")
                else:
                    print("頑張りました！次はもっと早く当てられるかもしれません")
                break
            elif guess > correct_number:
                print("💡 もっと小さい数字です")
            else:
                print("💡 もっと大きい数字です")
                
        except ValueError:
            print("エラー: 数字を正しく入力してください")
            attempts -= 1  # 無効な入力は試行回数にカウントしない
        except KeyboardInterrupt:
            print("\n\nゲームを中断しました。")
            return False

def main():
    """メインループ - 繰り返しゲームを可能にする"""
    while True:
        number_guessing_game()
        
        # 続行するかどうかを確認
        while True:
            try:
                choice = input("\nもう一度プレイしますか？ (y/n): ").lower().strip()
                if choice in ['y', 'yes', 'はい', 'Y']:
                    print("\n" + "="*50)  # 区切り線
                    break
                elif choice in ['n', 'no', 'いいえ', 'N']:
                    print("ゲームを終了します。ありがとうございました！")
                    return
                else:
                    print("y または n を入力してください。")
            except KeyboardInterrupt:
                print("\n\nゲームを終了します。ありがとうございました！")
                return

if __name__ == "__main__":
    main()